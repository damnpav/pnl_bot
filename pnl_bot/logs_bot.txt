hello1
hello1
hello2hello3hello3
hello3
2022-08-17 22:48:18: UPDATE ORDERS ERROR:
binance {"code":-1022,"msg":"Signature for this request is not valid."}

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/ccxt/base/exchange.py", line 620, in fetch
    response.raise_for_status()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 400 Client Error:  for url: https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1660765698537&recvWindow=10000&signature=66e7dc6a8d2b085914728f9a2bf8f346f51ac47fb217c3dde1c0b21bb9ec7194

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/update_orders_base.py", line 56, in <module>
    updated_df = update_orders(orders_path, exchange[0], exchange[1])
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/update_orders_base.py", line 31, in update_orders
    my_trades = search_trades(all_tickets, start_date, end_date, exchange)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/pnl_functions.py", line 55, in search_trades
    trades = exchange.fetch_my_trades(ticker, start_time, None, {'endTime': end_time})
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/ccxt/binance.py", line 3261, in fetch_my_trades
    self.load_markets()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/ccxt/base/exchange.py", line 1447, in load_markets
    currencies = self.fetch_currencies()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/ccxt/binance.py", line 1308, in fetch_currencies
    response = self.sapiGetCapitalConfigGetall(params)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/ccxt/base/exchange.py", line 500, in inner
    return entry(_self, **inner_kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/ccxt/binance.py", line 5514, in request
    response = self.fetch2(path, api, method, params, headers, body, config, context)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/ccxt/base/exchange.py", line 2624, in fetch2
    return self.fetch(request['url'], request['method'], request['headers'], request['body'])
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/ccxt/base/exchange.py", line 636, in fetch
    skip_further_error_handling = self.handle_errors(http_status_code, http_status_text, url, method, headers, http_response, json_response, request_headers, request_body)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/ccxt/binance.py", line 5492, in handle_errors
    self.throw_exactly_matched_exception(self.exceptions['exact'], error, feedback)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/ccxt/base/exchange.py", line 2867, in throw_exactly_matched_exception
    raise exact[string](message)
ccxt.base.errors.AuthenticationError: binance {"code":-1022,"msg":"Signature for this request is not valid."}

2022-08-18 02:16:13: Exception:
send_photo() got an unexpected keyword argument 'description'

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 173, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 104, in handle_buttons
    bot.send_photo(chat_id=chat_id, photo=recency_photo, description='Data recency per Ticker, apiKey:')
TypeError: send_photo() got an unexpected keyword argument 'description'

2022-08-20 15:43:30: UPDATE ORDERS ERROR:
"None of [Index(['id', 'datetime', 'symbol', 'side', 'price', 'amount', 'cost', 'fee'], dtype='object')] are in the [columns]"

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/update_orders_base.py", line 65, in <module>
    updated_df = update_orders(orders_path, exchange[0], exchange[1])
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/update_orders_base.py", line 40, in update_orders
    new_orders_df = trades_to_df(my_trades, exchange)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/pnl_functions.py", line 74, in trades_to_df
    output_df = trades_df[needed_cols]
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/frame.py", line 3511, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 5782, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 5842, in _raise_if_missing
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['id', 'datetime', 'symbol', 'side', 'price', 'amount', 'cost', 'fee'], dtype='object')] are in the [columns]"

2022-08-20 19:41:07: Exception:
[Errno 2] No such file or directory: 'orders_df1.csv'

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 209, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 122, in handle_buttons
    recency_df = data_recency(orders_path)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/pnl_functions.py", line 179, in data_recency
    orders_df = pd.read_csv(orders_path, sep=';')
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 680, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 575, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 934, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 1218, in _make_engine
    self.handles = get_handle(  # type: ignore[call-overload]
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/io/common.py", line 786, in get_handle
    handle = open(
FileNotFoundError: [Errno 2] No such file or directory: 'orders_df1.csv'

2022-08-20 19:48:17: Exception:
HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/sendMessage?chat_id=305402034&text=Data+recency+per+Ticker%2C+apiKey%3A&parse_mode=HTML (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x15904b0a0>, 'Connection to api.telegram.org timed out. (connect timeout=15)'))

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
socket.timeout: timed out

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 179, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPSConnection object at 0x15904b0a0>, 'Connection to api.telegram.org timed out. (connect timeout=15)')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/sendMessage?chat_id=305402034&text=Data+recency+per+Ticker%2C+apiKey%3A&parse_mode=HTML (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x15904b0a0>, 'Connection to api.telegram.org timed out. (connect timeout=15)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 213, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 128, in handle_buttons
    bot.send_message(chat_id, 'Data recency per Ticker, apiKey:', parse_mode='HTML')
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1451, in send_message
    apihelper.send_message(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/apihelper.py", line 267, in send_message
    return _make_request(token, method_url, params=payload, method='post')
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/apihelper.py", line 146, in _make_request
    result = _get_req_session().request(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/adapters.py", line 553, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/sendMessage?chat_id=305402034&text=Data+recency+per+Ticker%2C+apiKey%3A&parse_mode=HTML (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x15904b0a0>, 'Connection to api.telegram.org timed out. (connect timeout=15)'))

2022-08-20 19:48:49: Exception:
Invalid comparison between dtype=datetime64[ns, UTC] and datetime

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/arrays/datetimelike.py", line 536, in _validate_comparison_value
    self._check_compatible_with(other)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/arrays/datetimes.py", line 508, in _check_compatible_with
    self._assert_tzawareness_compat(other)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/arrays/datetimes.py", line 715, in _assert_tzawareness_compat
    raise TypeError(
TypeError: Cannot compare tz-naive and tz-aware datetime-like objects

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
    other = self._validate_comparison_value(other)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/arrays/datetimelike.py", line 539, in _validate_comparison_value
    raise InvalidComparison(other) from err
pandas.core.arrays.datetimelike.InvalidComparison: 2022-08-20 15:48:49.593888

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 213, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 56, in handle_buttons
    grouped_png_path, pnl_png_path = make_group_pnl(1)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 169, in make_group_pnl
    selected_df = orders_df.loc[(dt.utcnow() - td(hours=period_hours)) < orders_df['Date(UTC)']]
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/ops/common.py", line 70, in new_method
    return method(self, other)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/arraylike.py", line 56, in __gt__
    return self._cmp_method(other, operator.gt)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/series.py", line 5623, in _cmp_method
    res_values = ops.comparison_op(lvalues, rvalues, op)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/ops/array_ops.py", line 269, in comparison_op
    res_values = op(lvalues, rvalues)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/ops/common.py", line 70, in new_method
    return method(self, other)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/arraylike.py", line 56, in __gt__
    return self._cmp_method(other, operator.gt)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/arrays/datetimelike.py", line 1010, in _cmp_method
    return invalid_comparison(self, other, op)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/ops/invalid.py", line 34, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns, UTC] and datetime

2022-08-20 19:51:34: Exception:
can't compare datetime.datetime to datetime.date

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 213, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 56, in handle_buttons
    grouped_png_path, pnl_png_path = make_group_pnl(1)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 169, in make_group_pnl
    selected_df = orders_df.loc[(dt.utcnow() - td(hours=period_hours)) < orders_df['Date(UTC)']]
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/ops/common.py", line 70, in new_method
    return method(self, other)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/arraylike.py", line 56, in __gt__
    return self._cmp_method(other, operator.gt)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/series.py", line 5623, in _cmp_method
    res_values = ops.comparison_op(lvalues, rvalues, op)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/ops/array_ops.py", line 283, in comparison_op
    res_values = comp_method_OBJECT_ARRAY(op, lvalues, rvalues)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/ops/array_ops.py", line 73, in comp_method_OBJECT_ARRAY
    result = libops.scalar_compare(x.ravel(), y, op)
  File "pandas/_libs/ops.pyx", line 107, in pandas._libs.ops.scalar_compare
TypeError: can't compare datetime.datetime to datetime.date

2022-08-20 19:52:15: Exception:
'DatetimeProperties' object has no attribute 'datetime'

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 213, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 56, in handle_buttons
    grouped_png_path, pnl_png_path = make_group_pnl(1)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 168, in make_group_pnl
    orders_df['Date(UTC)'] = pd.to_datetime(orders_df['Date(UTC)']).dt.datetime
AttributeError: 'DatetimeProperties' object has no attribute 'datetime'

2022-08-20 19:56:44: Exception:
max() arg is an empty sequence

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 213, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 56, in handle_buttons
    grouped_png_path, pnl_png_path = make_group_pnl(1)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 175, in make_group_pnl
    dfi.export(grouped_df_styled, grouped_png_path, table_conversion='matplotlib')
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 24, in export
    return _export(obj, filename, fontsize, max_rows, max_cols, table_conversion, chrome_path)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 73, in _export
    img_str = converter(html)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_matplotlib_table.py", line 249, in run
    self.row_heights = self.get_row_heights()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_matplotlib_table.py", line 180, in get_row_heights
    row_count = max([val[0].count('\n') + 1 for val in row])
ValueError: max() arg is an empty sequence

2022-08-20 20:04:09: Exception:
max() arg is an empty sequence

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 213, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 56, in handle_buttons
    grouped_png_path, pnl_png_path = make_group_pnl(1)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 175, in make_group_pnl
    dfi.export(grouped_df_styled, grouped_png_path, table_conversion='matplotlib')
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 24, in export
    return _export(obj, filename, fontsize, max_rows, max_cols, table_conversion, chrome_path)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 73, in _export
    img_str = converter(html)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_matplotlib_table.py", line 249, in run
    self.row_heights = self.get_row_heights()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_matplotlib_table.py", line 180, in get_row_heights
    row_count = max([val[0].count('\n') + 1 for val in row])
ValueError: max() arg is an empty sequence

2022-08-20 20:05:06: Exception:
max() arg is an empty sequence

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 214, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 56, in handle_buttons
    grouped_png_path, pnl_png_path = make_group_pnl(1)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 176, in make_group_pnl
    dfi.export(grouped_df_styled, grouped_png_path, table_conversion='matplotlib')
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 24, in export
    return _export(obj, filename, fontsize, max_rows, max_cols, table_conversion, chrome_path)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 73, in _export
    img_str = converter(html)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_matplotlib_table.py", line 249, in run
    self.row_heights = self.get_row_heights()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_matplotlib_table.py", line 180, in get_row_heights
    row_count = max([val[0].count('\n') + 1 for val in row])
ValueError: max() arg is an empty sequence

2022-08-20 20:09:00: Exception:
HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/getUpdates?offset=1&timeout=20 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x1223b0610>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/socket.py", line 918, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x1223b0610>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/getUpdates?offset=1&timeout=20 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x1223b0610>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 214, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 976, in __threaded_polling
    polling_thread.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 116, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 601, in __retrieve_updates
    updates = self.get_updates(offset=(self.last_update_id + 1),
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 575, in get_updates
    json_updates = apihelper.get_updates(self.token, offset, limit, timeout, allowed_updates, long_polling_timeout)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/apihelper.py", line 324, in get_updates
    return _make_request(token, method_url, params=payload)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/apihelper.py", line 146, in _make_request
    result = _get_req_session().request(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/getUpdates?offset=1&timeout=20 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x1223b0610>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

2022-08-20 20:09:34: Exception:
HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/getUpdates?offset=1&timeout=20 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x132dbe5e0>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/socket.py", line 918, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x132dbe5e0>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/getUpdates?offset=1&timeout=20 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x132dbe5e0>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 214, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 976, in __threaded_polling
    polling_thread.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 116, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 601, in __retrieve_updates
    updates = self.get_updates(offset=(self.last_update_id + 1),
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 575, in get_updates
    json_updates = apihelper.get_updates(self.token, offset, limit, timeout, allowed_updates, long_polling_timeout)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/apihelper.py", line 324, in get_updates
    return _make_request(token, method_url, params=payload)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/apihelper.py", line 146, in _make_request
    result = _get_req_session().request(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/getUpdates?offset=1&timeout=20 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x132dbe5e0>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

2022-08-20 20:09:42: Exception:
HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/getUpdates?offset=1&timeout=20 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x11d6ecaf0>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/socket.py", line 918, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x11d6ecaf0>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/getUpdates?offset=1&timeout=20 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x11d6ecaf0>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 214, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 976, in __threaded_polling
    polling_thread.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 116, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 601, in __retrieve_updates
    updates = self.get_updates(offset=(self.last_update_id + 1),
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 575, in get_updates
    json_updates = apihelper.get_updates(self.token, offset, limit, timeout, allowed_updates, long_polling_timeout)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/apihelper.py", line 324, in get_updates
    return _make_request(token, method_url, params=payload)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/apihelper.py", line 146, in _make_request
    result = _get_req_session().request(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/getUpdates?offset=1&timeout=20 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x11d6ecaf0>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

2022-08-20 20:33:43: Exception:
HTTPSConnectionPool(host='api.telegram.org', port=443): Read timed out. (read timeout=25)

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 449, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 444, in _make_request
    httplib_response = conn.getresponse()
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/http/client.py", line 1344, in getresponse
    response.begin()
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/http/client.py", line 307, in begin
    version, status, reason = self._read_status()
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/http/client.py", line 268, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/socket.py", line 669, in readinto
    return self._sock.recv_into(b)
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/ssl.py", line 1241, in recv_into
    return self.read(nbytes, buffer)
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/ssl.py", line 1099, in read
    return self._sslobj.read(len, buffer)
socket.timeout: The read operation timed out

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/util/retry.py", line 550, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/packages/six.py", line 770, in reraise
    raise value
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 451, in _make_request
    self._raise_timeout(err=e, url=url, timeout_value=read_timeout)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 340, in _raise_timeout
    raise ReadTimeoutError(
urllib3.exceptions.ReadTimeoutError: HTTPSConnectionPool(host='api.telegram.org', port=443): Read timed out. (read timeout=25)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 214, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 976, in __threaded_polling
    polling_thread.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 116, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 601, in __retrieve_updates
    updates = self.get_updates(offset=(self.last_update_id + 1),
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 575, in get_updates
    json_updates = apihelper.get_updates(self.token, offset, limit, timeout, allowed_updates, long_polling_timeout)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/apihelper.py", line 324, in get_updates
    return _make_request(token, method_url, params=payload)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/apihelper.py", line 146, in _make_request
    result = _get_req_session().request(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/adapters.py", line 578, in send
    raise ReadTimeout(e, request=request)
requests.exceptions.ReadTimeout: HTTPSConnectionPool(host='api.telegram.org', port=443): Read timed out. (read timeout=25)

2022-08-20 20:41:15: Exception:
HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/getUpdates?offset=865958716&timeout=20 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x1323d4820>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/socket.py", line 918, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x1323d4820>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/getUpdates?offset=865958716&timeout=20 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x1323d4820>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 214, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 976, in __threaded_polling
    polling_thread.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 116, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 601, in __retrieve_updates
    updates = self.get_updates(offset=(self.last_update_id + 1),
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 575, in get_updates
    json_updates = apihelper.get_updates(self.token, offset, limit, timeout, allowed_updates, long_polling_timeout)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/apihelper.py", line 324, in get_updates
    return _make_request(token, method_url, params=payload)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/apihelper.py", line 146, in _make_request
    result = _get_req_session().request(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/getUpdates?offset=865958716&timeout=20 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x1323d4820>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

2022-08-20 20:41:45: Exception:
HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/getUpdates?offset=865958716&timeout=20 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x1323e9820>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/socket.py", line 918, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 386, in _make_request
    self._validate_conn(conn)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1042, in _validate_conn
    conn.connect()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 358, in connect
    self.sock = conn = self._new_conn()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x1323e9820>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/getUpdates?offset=865958716&timeout=20 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x1323e9820>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 214, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 976, in __threaded_polling
    polling_thread.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 116, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 601, in __retrieve_updates
    updates = self.get_updates(offset=(self.last_update_id + 1),
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 575, in get_updates
    json_updates = apihelper.get_updates(self.token, offset, limit, timeout, allowed_updates, long_polling_timeout)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/apihelper.py", line 324, in get_updates
    return _make_request(token, method_url, params=payload)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/apihelper.py", line 146, in _make_request
    result = _get_req_session().request(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot5402387181:AAGa0rmEBp2qTAb5LUtbYw3TI93XqJ6Ev4U/getUpdates?offset=865958716&timeout=20 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x1323e9820>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

2022-08-20 20:53:42: Exception:
max() arg is an empty sequence

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 214, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 82, in handle_buttons
    grouped_png_path, pnl_png_path = make_group_pnl(4)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 176, in make_group_pnl
    dfi.export(grouped_df_styled, grouped_png_path, table_conversion='matplotlib')
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 24, in export
    return _export(obj, filename, fontsize, max_rows, max_cols, table_conversion, chrome_path)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 73, in _export
    img_str = converter(html)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_matplotlib_table.py", line 249, in run
    self.row_heights = self.get_row_heights()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_matplotlib_table.py", line 180, in get_row_heights
    row_count = max([val[0].count('\n') + 1 for val in row])
ValueError: max() arg is an empty sequence

2022-08-20 20:57:25: Exception:
max() arg is an empty sequence

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 220, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 83, in handle_buttons
    grouped_png_path, pnl_png_path = make_group_pnl(4)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 182, in make_group_pnl
    dfi.export(grouped_df_styled, grouped_png_path, table_conversion='matplotlib')
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 24, in export
    return _export(obj, filename, fontsize, max_rows, max_cols, table_conversion, chrome_path)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 73, in _export
    img_str = converter(html)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_matplotlib_table.py", line 249, in run
    self.row_heights = self.get_row_heights()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_matplotlib_table.py", line 180, in get_row_heights
    row_count = max([val[0].count('\n') + 1 for val in row])
ValueError: max() arg is an empty sequence

2022-08-20 21:02:39: Exception:
max() arg is an empty sequence

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 244, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 93, in handle_buttons
    grouped_png_path, pnl_png_path = make_group_pnl(4)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 206, in make_group_pnl
    dfi.export(grouped_df_styled, grouped_png_path, table_conversion='matplotlib')
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 24, in export
    return _export(obj, filename, fontsize, max_rows, max_cols, table_conversion, chrome_path)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 73, in _export
    img_str = converter(html)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_matplotlib_table.py", line 249, in run
    self.row_heights = self.get_row_heights()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_matplotlib_table.py", line 180, in get_row_heights
    row_count = max([val[0].count('\n') + 1 for val in row])
ValueError: max() arg is an empty sequence

2022-08-20 21:03:46: Exception:
max() arg is an empty sequence

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 243, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 93, in handle_buttons
    grouped_png_path, pnl_png_path = make_group_pnl(4)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 205, in make_group_pnl
    dfi.export(grouped_df_styled, grouped_png_path, table_conversion='matplotlib')
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 24, in export
    return _export(obj, filename, fontsize, max_rows, max_cols, table_conversion, chrome_path)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 73, in _export
    img_str = converter(html)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_matplotlib_table.py", line 249, in run
    self.row_heights = self.get_row_heights()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_matplotlib_table.py", line 180, in get_row_heights
    row_count = max([val[0].count('\n') + 1 for val in row])
ValueError: max() arg is an empty sequence

2022-09-03 11:09:32: UPDATE ORDERS ERROR:
"None of [Index(['id', 'datetime', 'symbol', 'side', 'price', 'amount', 'cost', 'fee'], dtype='object')] are in the [columns]"

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/update_orders_base.py", line 65, in <module>
    updated_df = update_orders(orders_path, exchange[0], exchange[1])
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/update_orders_base.py", line 40, in update_orders
    new_orders_df = trades_to_df(my_trades, exchange)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/pnl_functions.py", line 74, in trades_to_df
    output_df = trades_df[needed_cols]
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/frame.py", line 3511, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 5782, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 5842, in _raise_if_missing
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['id', 'datetime', 'symbol', 'side', 'price', 'amount', 'cost', 'fee'], dtype='object')] are in the [columns]"

2022-09-04 21:50:00: UPDATE ORDERS ERROR:
The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/update_orders_base.py", line 70, in <module>
    if updated_df != 0:
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/generic.py", line 1527, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2022-09-04 21:53:54: UPDATE ORDERS ERROR:
The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/update_orders_base.py", line 68, in <module>
    if updated_df:
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/generic.py", line 1527, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().

2022-09-04 21:57:37: UPDATE ORDERS ERROR:
'bool' object is not callable

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/update_orders_base.py", line 68, in <module>
    if not updated_df.empty():
TypeError: 'bool' object is not callable

2022-09-04 22:05:32: UPDATE ORDERS ERROR:
string indices must be integers

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/update_orders_base.py", line 69, in <module>
    updated_df = update_orders(orders_path, exchange[0], exchange[1])
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/update_orders_base.py", line 30, in update_orders
    if exchange.apiKey in list(orders_df['apiKey'].unique()):
TypeError: string indices must be integers

2022-09-04 22:08:00: UPDATE ORDERS ERROR:
string indices must be integers

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/update_orders_base.py", line 69, in <module>
    updated_df = update_orders(orders_path, exchange_item[0], exchange_item[1])
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/update_orders_base.py", line 30, in update_orders
    if exchange.apiKey in list(orders_df['apiKey'].unique()):
TypeError: string indices must be integers

2022-09-04 22:55:18: User pnl_binance_bot not in bot_users
2022-09-04 22:57:22: Exception:
local variable 'market' referenced before assignment

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 248, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 63, in handle_buttons
    grouped_png_path, pnl_png_path = make_group_pnl(1)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 202, in make_group_pnl
    grouped_df, pnl_df = grouping_pnl(selected_df, period_hours)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/pnl_functions.py", line 152, in grouping_pnl
    buy_total_dict[market] = round(buy_total_dict[market], 2)
UnboundLocalError: local variable 'market' referenced before assignment

2022-09-05 19:34:19: Exception:
cannot convert float infinity to integer

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 248, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 135, in handle_buttons
    grouped_png_path, pnl_png_path = make_group_pnl(24)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 202, in make_group_pnl
    grouped_df, pnl_df = grouping_pnl(selected_df, period_hours)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/pnl_functions.py", line 157, in grouping_pnl
    deals_per_hours_dict[market] = round(deals_per_hours_dict[market])
OverflowError: cannot convert float infinity to integer

2022-09-06 19:47:50: Exception:
nothing to repeat at position 0

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 261, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 976, in __threaded_polling
    polling_thread.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 116, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 604, in __retrieve_updates
    self.process_new_updates(updates)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 692, in process_new_updates
    self.process_new_messages(new_messages)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 727, in process_new_messages
    self._notify_command_handlers(self.message_handlers, new_messages, 'message')
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 5965, in _notify_command_handlers
    if self._test_message_handler(message_handler, message):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 5795, in _test_message_handler
    if not self._test_filter(message_filter, filter_value, message):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 5830, in _test_filter
    return message.content_type == 'text' and re.search(filter_value, message.text, re.IGNORECASE)
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/re.py", line 201, in search
    return _compile(pattern, flags).search(string)
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/re.py", line 304, in _compile
    p = sre_compile.compile(pattern, flags)
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/sre_compile.py", line 764, in compile
    p = sre_parse.parse(p, flags)
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/sre_parse.py", line 948, in parse
    p = _parse_sub(source, state, flags & SRE_FLAG_VERBOSE, 0)
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/sre_parse.py", line 443, in _parse_sub
    itemsappend(_parse(source, state, verbose, nested + 1,
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/sre_parse.py", line 668, in _parse
    raise source.error("nothing to repeat",
re.error: nothing to repeat at position 0

2022-09-06 19:48:27: Exception:
multiple repeat at position 4

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 261, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 976, in __threaded_polling
    polling_thread.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 116, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 604, in __retrieve_updates
    self.process_new_updates(updates)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 692, in process_new_updates
    self.process_new_messages(new_messages)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 727, in process_new_messages
    self._notify_command_handlers(self.message_handlers, new_messages, 'message')
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 5965, in _notify_command_handlers
    if self._test_message_handler(message_handler, message):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 5795, in _test_message_handler
    if not self._test_filter(message_filter, filter_value, message):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 5830, in _test_filter
    return message.content_type == 'text' and re.search(filter_value, message.text, re.IGNORECASE)
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/re.py", line 201, in search
    return _compile(pattern, flags).search(string)
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/re.py", line 304, in _compile
    p = sre_compile.compile(pattern, flags)
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/sre_compile.py", line 764, in compile
    p = sre_parse.parse(p, flags)
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/sre_parse.py", line 948, in parse
    p = _parse_sub(source, state, flags & SRE_FLAG_VERBOSE, 0)
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/sre_parse.py", line 443, in _parse_sub
    itemsappend(_parse(source, state, verbose, nested + 1,
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/sre_parse.py", line 671, in _parse
    raise source.error("multiple repeat",
re.error: multiple repeat at position 4

2022-09-08 08:56:04: Exception:
HTTPSConnectionPool(host='api.telegram.org', port=443): Read timed out. (read timeout=25)

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 449, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 444, in _make_request
    httplib_response = conn.getresponse()
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/http/client.py", line 1344, in getresponse
    response.begin()
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/http/client.py", line 307, in begin
    version, status, reason = self._read_status()
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/http/client.py", line 268, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/socket.py", line 669, in readinto
    return self._sock.recv_into(b)
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/ssl.py", line 1241, in recv_into
    return self.read(nbytes, buffer)
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/ssl.py", line 1099, in read
    return self._sslobj.read(len, buffer)
socket.timeout: The read operation timed out

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/util/retry.py", line 550, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/packages/six.py", line 770, in reraise
    raise value
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 451, in _make_request
    self._raise_timeout(err=e, url=url, timeout_value=read_timeout)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/urllib3/connectionpool.py", line 340, in _raise_timeout
    raise ReadTimeoutError(
urllib3.exceptions.ReadTimeoutError: HTTPSConnectionPool(host='api.telegram.org', port=443): Read timed out. (read timeout=25)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 260, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 976, in __threaded_polling
    polling_thread.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 116, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 601, in __retrieve_updates
    updates = self.get_updates(offset=(self.last_update_id + 1),
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 575, in get_updates
    json_updates = apihelper.get_updates(self.token, offset, limit, timeout, allowed_updates, long_polling_timeout)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/apihelper.py", line 324, in get_updates
    return _make_request(token, method_url, params=payload)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/apihelper.py", line 146, in _make_request
    result = _get_req_session().request(
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/requests/adapters.py", line 578, in send
    raise ReadTimeout(e, request=request)
requests.exceptions.ReadTimeout: HTTPSConnectionPool(host='api.telegram.org', port=443): Read timed out. (read timeout=25)

2022-09-14 20:33:12: Exception:
"None of [''] are in the columns"

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 260, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 143, in handle_buttons
    grouped_png_path, pnl_png_path = make_group_pnl(24)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 210, in make_group_pnl
    grouped_df, pnl_df = grouping_pnl(selected_df, period_hours)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/pnl_functions.py", line 216, in grouping_pnl
    pnl_df = pnl_df.set_index('')
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/frame.py", line 5500, in set_index
    raise KeyError(f"None of {missing} are in the columns")
KeyError: "None of [''] are in the columns"

2022-09-15 19:15:48: Exception:
"None of [''] are in the columns"

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 260, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 143, in handle_buttons
    grouped_png_path, pnl_png_path = make_group_pnl(24)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 210, in make_group_pnl
    grouped_df, pnl_df = grouping_pnl(selected_df, period_hours)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/pnl_functions.py", line 217, in grouping_pnl
    pnl_df = pnl_df.set_index('')
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/frame.py", line 5500, in set_index
    raise KeyError(f"None of {missing} are in the columns")
KeyError: "None of [''] are in the columns"

2022-09-15 19:20:52: Exception:
'Type'

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3621, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 136, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 163, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Type'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 260, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 143, in handle_buttons
    grouped_png_path, pnl_png_path = make_group_pnl(24)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 210, in make_group_pnl
    grouped_df, pnl_df = grouping_pnl(selected_df, period_hours)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/pnl_functions.py", line 219, in grouping_pnl
    del pnl_df['Type']
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/generic.py", line 4048, in __delitem__
    loc = self.axes[-1].get_loc(key)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3623, in get_loc
    raise KeyError(key) from err
KeyError: 'Type'

2022-09-17 16:14:37: Exception:
expected string or bytes-like object

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 309, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 80, in regex_handler
    hour_message = re.findall('h\d+', message)
  File "/Users/dp_user/.pyenv/versions/3.8.10/lib/python3.8/re.py", line 241, in findall
    return _compile(pattern, flags).findall(string)
TypeError: expected string or bytes-like object

2022-09-17 16:18:40: Exception:
'Message' object has no attribute 'data'

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 310, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 75, in regex_handler
    msg = message.data
AttributeError: 'Message' object has no attribute 'data'

2022-09-17 16:21:40: Exception:
Your DataFrame has more than 30 columns and will produce a huge image file, possibly causing your computer to crash. Override this error by explicitly setting `max_cols`. Use -1 for all columns.

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 310, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 86, in regex_handler
    grouped_png_path, pnl_png_path = make_group_pnl(hour_int)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 272, in make_group_pnl
    dfi.export(grouped_df, grouped_png_path, table_conversion='matplotlib')
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 24, in export
    return _export(obj, filename, fontsize, max_rows, max_cols, table_conversion, chrome_path)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 63, in _export
    raise ValueError(error_msg)
ValueError: Your DataFrame has more than 30 columns and will produce a huge image file, possibly causing your computer to crash. Override this error by explicitly setting `max_cols`. Use -1 for all columns.

2022-09-17 16:22:10: Exception:
Your DataFrame has more than 30 columns and will produce a huge image file, possibly causing your computer to crash. Override this error by explicitly setting `max_cols`. Use -1 for all columns.

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 310, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 86, in regex_handler
    grouped_png_path, pnl_png_path = make_group_pnl(hour_int)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 272, in make_group_pnl
    dfi.export(grouped_df, grouped_png_path, table_conversion='matplotlib')
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 24, in export
    return _export(obj, filename, fontsize, max_rows, max_cols, table_conversion, chrome_path)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 63, in _export
    raise ValueError(error_msg)
ValueError: Your DataFrame has more than 30 columns and will produce a huge image file, possibly causing your computer to crash. Override this error by explicitly setting `max_cols`. Use -1 for all columns.

2022-09-17 16:24:46: Exception:
Your DataFrame has more than 30 columns and will produce a huge image file, possibly causing your computer to crash. Override this error by explicitly setting `max_cols`. Use -1 for all columns.

Traceback:
Traceback (most recent call last):
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 310, in <module>
    bot.polling()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 946, in polling
    self.__threaded_polling(non_stop=non_stop, interval=interval, timeout=timeout, long_polling_timeout=long_polling_timeout,
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 1021, in __threaded_polling
    raise e
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/__init__.py", line 977, in __threaded_polling
    self.worker_pool.raise_exceptions()
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 154, in raise_exceptions
    raise self.exception_info
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/telebot/util.py", line 98, in run
    task(*args, **kwargs)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 86, in regex_handler
    grouped_png_path, pnl_png_path = make_group_pnl(hour_int)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/pnl_bot/tele_bot.py", line 272, in make_group_pnl
    dfi.export(grouped_df, grouped_png_path, table_conversion='matplotlib', max_rows=-1)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 24, in export
    return _export(obj, filename, fontsize, max_rows, max_cols, table_conversion, chrome_path)
  File "/Users/dp_user/PycharmProjects/pnl_bot/pnl_bot/.venv/lib/python3.8/site-packages/dataframe_image/_pandas_accessor.py", line 63, in _export
    raise ValueError(error_msg)
ValueError: Your DataFrame has more than 30 columns and will produce a huge image file, possibly causing your computer to crash. Override this error by explicitly setting `max_cols`. Use -1 for all columns.

